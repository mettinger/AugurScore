<html>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <head>
        <title>{{ title }}</title>
    </head>
    <body>
        <h1>AugurScore - Evaluating Augur's probability estimates</h1>
       <ul>
           <li>The purpose of this site is to explore the accuracy of the probability estimates generated by Augur.  Every completed trade on Augur can be considered the market's best estimate of the probability for a given outcome.  It is then natural to ask how accurate a set of probability predictions turn out to be when the events are finalized.</li><br>
           <li>Here is a simple example.  Weather forecasters often say "There is a 70% chance of rain tomorrow."  We would expect that given a large collection of days where the forecast is for a 70% chance of rain the following day, then approximately 70% would indeed experience rainfall on the following day.  Does this expectation turn out to be the case?  In other words, are weather forecasters generating well-calibrated probability estimates?</li><br>
           <li>We can use data from Augur to explore the quality of market-based probability estimates over a diverse set of events, including sporting events, political events, etc.</li><br>
           <li>In statistics and machine learning "scoring rules" are used to measure the accuracy of probability predictions.  So scoring rules are similar to loss functions in machine learning.  On this site we evaluate several scoring rules on Augur probability predictions.  For a brief overview of scoring rules, see the <a href="https://en.wikipedia.org/wiki/Scoring_rule">Wikipedia article.</a></li><br>
           <li>Probabilities for outcomes change over time.  For example, predictions seven days in advance are presumably less accurate than predictions one day in advance.  We allow the user to specify the timepoint of interest.</li><br>
           <li>In order to estimate a probability at a given timepoint we use a weighted average of "nearby" trade prices.  All probabilities (i.e. trade prices) are temporally weighted by a kernel function centered at the timepoint of interest.  The user can specify the form of the kernel function and the kernel width.</li><br>
           <li>All probabilities are also weighted by trade volume (in addition to the temporal weight).</li><br>
           <li>At the moment, AugurScore only supports analysis on Yes/No markets.</li><br>
           <li>We also generate a calibration plot which directly illustrates the relationship between the predicted probabilities and the observed, empirical frequencies.  A perfect probability predictor would generate a straight, diagonal line, i.e. predicted probability = observed frequency.  For the calibration plot calculation we again utilize a kernel function but this time in "price/probability space."</li><br>
           <li>Technical details:  We use the Augur API (augur.js) to pull the data from an Augur Node.  We use Python to process the data.  This website is written in Python with Flask.</li><br>
           <li>Here is the code on GitHub: <a href="https://github.com/mettinger/AugurScore"> github.com/mettinger/AugurScore </a></li><br>
           <li>TODO:
               <ul>
                   <li>Improve interface to allow selecting a subset of events to analyze (for example, only political events or a designated set of markets).</li><br>
                   <li>Add more kernel functions.</li><br>
                   <li>Instead of only using trades as probability estimates, would it be better to use the midpoint of buy/sell open orders?</li><br>
                   <li>Become a respectable web developer and make this site pretty.</li><br>
               </ul>
           </li><br>
      </ul>
        <form action="{{ url_for('index') }}" method="post" novalidate>
            {{ form.csrf_token }}
            <p>
                {{ form.kernelFunction.label }}<br>
                {{ form.kernelFunction(size=3) }}
            </p>
            <p>
                {{ form.kernelWidth.label }}<br>
                {{ form.kernelWidth(size=32) }}
            </p>
            <p>
                {{ form.daysAhead.label }}<br>
                {{ form.daysAhead(size=32) }}
            </p>
            <p>
                {{ form.kernelFunctionCalibrated.label }}<br>
                {{ form.kernelFunctionCalibrated(size=3) }}
            </p>
            <p>
                {{ form.kernelWidthCalibrated.label }}<br>
                {{ form.kernelWidthCalibrated(size=32) }}
            </p>
            <p>{{ form.submit() }}</p>
        </form>
        {% if scores %}
        <h1>Kernel-weighted volume: {{ weightedVolume }}</h1>
        <h1>Log score: {{ scores['logScore'] }}</h1>
        <h1>Brier score: {{ scores['brierScore'] }}</h1>
        <h1>Spherical score: {{ scores['sphericalScore'] }}</h1>
        {% endif %}
    
        {% if filePath %}
        <img src="{{ filePath }}" alt="probabilistic confusion matrix">
        {% endif %}
        
    </body>
</html>
